(function(t){function e(e){for(var a,s,o=e[0],l=e[1],c=e[2],d=0,h=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);u&&u(e);while(h.length)h.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,o=1;o<n.length;o++){var l=n[o];0!==i[l]&&(a=!1)}a&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var a={},i={app:0},r=[];function s(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=a,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(n,a,function(e){return t[e]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/vue-barrage/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"0f77":function(t,e,n){},"5a4a":function(t,e,n){"use strict";var a=n("82a1"),i=n.n(a);i.a},"82a1":function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],s=n("2877"),o={},l=Object(s["a"])(o,i,r,!1,null,null,null),c=l.exports,u=n("8c4f"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("h2",{staticStyle:{"text-align":"center"}},[t._v("Vue-barrage 基于vue的弹幕组件")]),n("div",{staticStyle:{height:"400px",width:"800px",position:"relative",margin:"0px auto",background:"#000"}},[n("v-barrage",{attrs:{arr:t.arr,isPause:t.isPause,percent:100}})],1),n("div",{staticClass:"barrage-control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.sendContent,expression:"sendContent"}],attrs:{type:"text",placeholder:"回车发送",id:"sendContent"},domProps:{value:t.sendContent},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendBarrage(e)},input:function(e){e.target.composing||(t.sendContent=e.target.value)}}}),t._v(" 方向: "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.direction,expression:"direction"}],staticStyle:{margin:"0px 12px"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.direction=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"default"}},[t._v("默认")]),n("option",{attrs:{value:"top"}},[t._v("顶部")])]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.isJs,expression:"isJs"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.isJs)?t._i(t.isJs,null)>-1:t.isJs},on:{change:function(e){var n=t.isJs,a=e.target,i=!!a.checked;if(Array.isArray(n)){var r=null,s=t._i(n,r);a.checked?s<0&&(t.isJs=n.concat([r])):s>-1&&(t.isJs=n.slice(0,s).concat(n.slice(s+1)))}else t.isJs=i}}}),t._v(" js弹幕(直接写代码) "),n("button",{staticStyle:{"margin-left":"25px"},attrs:{id:"sendBarrageBtn"},on:{click:t.sendBarrage}},[t._v("发送")]),n("button",{attrs:{id:"pauseBtn"},on:{click:function(e){t.isPause=!0}}},[t._v("暂停")]),n("button",{attrs:{id:"startBtn"},on:{click:function(e){t.isPause=!1}}},[t._v("开始")])])])},h=[],f=(n("e25e"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{ref:"barrageWrapper",staticClass:"barrage-wrapper",style:{height:t.percent+"%"}},[n("div",{staticClass:"barrage-main"},[n("div",{ref:"barrageMainDm",staticClass:"barrage-main-dm",class:{"ani-pause":t.isPause,"ani-running":!t.isPause}})])])}),p=[],m=(n("99af"),n("7db0"),n("4160"),n("caad"),n("a9e3"),n("b64b"),n("2532"),n("159b"),{props:{arr:{type:Array,default:function(){return[]}},isPause:{type:Boolean},percent:{type:Number,default:80}},data:function(){return{MAX_DM_COUNT:5,CHANNEL_COUNT:8,barrages:[],domPool:[],intervalDM:null,interValTime:500,hasPosition:[],hasTopPosition:[],barrageMainDm:null,barMainWidth:500,dmStyles:["color","fontSize"]}},computed:{},created:function(){},mounted:function(){this.barrageMainDm=this.$refs.barrageMainDm,this.barMainWidth=this.barrageMainDm.clientWidth,this.init(),this.playDm(),document.addEventListener("visibilitychange",this.visibilitychangeFn)},watch:{arr:function(t){this.barrages=t},isPause:function(t){t?this.pauseDm():this.playDm()},percent:function(t){this.CHANNEL_COUNT=t/10}},methods:{visibilitychangeFn:function(){document.hidden?(clearInterval(this.intervalDM),this.intervalDM=null):this.playDm()},init:function(){for(var t=this,e=(this.$refs.barrageMainDm,function(e){for(var n=[],a=function(a){var i=document.createElement("div");i.className="barrage-item",i.style.transform="translate3d(".concat(t.barMainWidth,"px,0,0)"),i.style.top=e*(t.barrageMainDm.clientHeight/t.CHANNEL_COUNT)+"px",i.addEventListener("animationend",(function(n){i.className="barrage-item",i.style.transform="translate3d(".concat(t.barMainWidth,"px,0,0)"),i.style.animation=null,t.dmStyles.forEach((function(t){i.style[t]=null})),t.domPool[a][e]&&(t.domPool[a][e].isFree=!1)})),n.push({row:e,col:a,el:i,isUse:!1,isFree:!1})},i=0;i<t.MAX_DM_COUNT;i++)a(i);t.domPool.push(n)}),n=0;n<this.CHANNEL_COUNT;n++)e(n);for(var a=0;a<this.CHANNEL_COUNT;a++)this.hasPosition[a]=!0,this.hasTopPosition[a]=!0},getChannel:function(){for(var t=0;t<this.CHANNEL_COUNT;t++)if(this.hasPosition[t]&&this.domPool[t].length)return t;return-1},getTopChannel:function(){for(var t=0;t<this.CHANNEL_COUNT;t++)if(this.hasTopPosition[t])return t;return-1},shootDanmu:function(t,e,n){var a=this;this.hasPosition[n]=!1;var i=t.el;if(!t.isUse&&this.barrageMainDm&&(t.isUse=!0,this.barrageMainDm.appendChild(t.el)),e.style){var r=Object.keys(e.style),s=this;r.forEach((function(t){var n=s.dmStyles.includes(t);n&&(i.style[t]=e.style[t])}))}t.isFree=!0,e.isJs?i.innerHTML=e.content:i.innerText=e.content,i.className=e.isSelf?"barrage-item self-dm":"barrage-item",i.style.animation="barrage-run 5s linear",setTimeout((function(){a.hasPosition[n]=!0}),10*i.clientWidth+1e3)},shootTopDanmu:function(t,e){var n=this;this.hasTopPosition[e]=!1;var a=document.createElement("div");if(a.className=t.isSelf?"barrage-item top-item self-dm":"barrage-item top-item",t.style){var i=Object.keys(t.style),r=this;i.forEach((function(e){var n=r.dmStyles.includes(e);n&&(a.style[e]=t.style[e])}))}t.isJs?a.innerHTML=t.content:a.innerText=t.content,a.addEventListener("animationend",(function(){n.barrageMainDm.removeChild(a),n.hasTopPosition[e]=!0})),this.barrageMainDm.appendChild(a),a.style.transform="translate3d(".concat(this.barMainWidth/2-a.clientWidth/2,"px,").concat(e*a.clientHeight,"px,0)"),a.style.animation="barrage-fade 3s"},getFreeChannelDom:function(t){var e;return e=this.domPool[t].find((function(t){return!t.isFree})),e},pauseDm:function(){this.intervalDM&&(clearInterval(this.intervalDM),this.intervalDM=null)},playDm:function(){var t=this;t.intervalDM=setInterval((function(){if(t.barrages.length>0){var e,n,a=t.barrages.shift();if("top"==a.direction&&-1!=(n=t.getTopChannel())&&t.shootTopDanmu(a,n),"default"==a.direction&&-1!=(e=t.getChannel())){var i=t.getFreeChannelDom(e);i&&t.shootDanmu(i,a,e)}}}),t.interValTime)}},components:{}}),v=m,g=(n("f9a7"),Object(s["a"])(v,f,p,!1,null,null,null)),b=g.exports,y={name:"home",components:{VBarrage:b},data:function(){return{arr:[],isPause:!1,sendContent:null,isJs:!1,direction:"default"}},mounted:function(){this.initTestData()},methods:{initTestData:function(){for(var t=["这是一条有弹幕","今天去打LOL","可以吗？","一起嗨！！！"],e=0;e<6;e++)for(var n=0;n<1e3;n++)n%2==0?this.arr.push({direction:"top",content:t[parseInt(Math.random()*t.length)]}):this.arr.push({direction:"default",content:t[parseInt(Math.random()*t.length)]})},sendBarrage:function(){this.arr.length>1&&""!=this.sendContent&&null!=this.sendContent?this.arr.unshift({content:this.sendContent,direction:this.direction,isSelf:!0,style:{color:"red",fontSize:"25px"},isJs:this.isJs}):this.arr.push({content:this.sendContent,direction:this.direction,isSelf:!0,style:{color:"red"},isJs:this.isJs}),this.sendContent=null}}},C=y,_=(n("5a4a"),Object(s["a"])(C,d,h,!1,null,"79aee4a0",null)),M=_.exports;a["a"].use(u["a"]);var D=[{path:"/",name:"home",component:M}],P=new u["a"]({routes:D}),N=P,x=n("2f62");a["a"].use(x["a"]);var T=new x["a"].Store({state:{},mutations:{},actions:{},modules:{}});a["a"].config.productionTip=!1,new a["a"]({router:N,store:T,render:function(t){return t(c)}}).$mount("#app")},f9a7:function(t,e,n){"use strict";var a=n("0f77"),i=n.n(a);i.a}});
//# sourceMappingURL=app.4b591839.js.map